<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sheet Music ‚Üí MIDI (Three-Staff Editor)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600&family=IBM+Plex+Mono:wght@400;500&family=Inter:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="mist-overlay"></div>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="brand__title">Sheet Music ‚Üí MIDI</div>
        <div class="brand__sub">three-staff composer</div>
      </div>
      <span class="badge"><span class="dot"></span> Editor Active</span>
    </header>

    <section class="panel" id="controlsPanel">
      <div class="panel__head">
        <div class="panel__title">Controls</div>
        <div class="panel__meta">
          <button class="panel__toggle" title="Collapse">‚ñº</button>
        </div>
      </div>
      <div class="panel__body controls" id="controls">
      <div class="cell" style="grid-column: span 2; min-width: 120px">
        <label for="bpm">Tempo (BPM)</label>
        <input id="bpm" type="number" value="100" min="30" max="240" />
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 120px">
        <label for="volume">Volume</label>
        <input id="volume" type="range" min="0" max="100" value="70" />
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 140px">
        <label>Active Staff</label>
        <select id="activeStaff">
          <option value="0" selected>Melody (Treble)</option>
          <option value="1">Right Hand (Treble)</option>
          <option value="2">Left Hand (Bass)</option>
        </select>
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 140px">
        <label>Snap</label>
        <select id="snap">
          <option value="1">Whole</option>
          <option value="2">Half</option>
          <option value="4" selected>Quarter</option>
          <option value="8">Eighth</option>
          <option value="16">Sixteenth</option>
        </select>
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 140px">
        <label>Accidental</label>
        <select id="accidental">
          <option value="0" selected>Natural</option>
          <option value="1">Sharp</option>
          <option value="-1">Flat</option>
        </select>
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 140px">
        <label>Tool</label>
        <select id="tool">
          <option value="note" selected>Place note</option>
          <option value="erase">Erase</option>
        </select>
      </div>
      <div class="cell" style="grid-column: span 2; min-width: 140px">
        <label>Magic Mode</label>
        <select id="magicMode">
          <option value="phrase" selected>‚ú® Phrase (8-bar arc)</option>
          <option value="loop">üîÅ Loop (tight, repetitive)</option>
          <option value="drift">üåä Drift (sparse, asymmetric)</option>
        </select>
      </div>
      <div class="cell button-row" style="grid-column: span 6;">
        <button id="randomize" class="magic">Magic</button>
        <button id="undo">Undo</button>
        <button id="clear">Clear</button>
        <button id="loop">Loop</button>
        <button id="play" class="green">Play</button>
        <button id="download" class="primary">Export MIDI</button>
      </div>
      <div class="sep"></div>
      <div class="cell" style="grid-column: 1 / -1">
        <label>Tip</label>
        <div style="color:var(--text-muted)">Click on any staff to add notes. <b>Three staves</b>: Melody, Right Hand (both treble clef), and Left Hand (bass clef). Press <kbd>1</kbd>, <kbd>2</kbd>, <kbd>3</kbd> to switch staves. Magic generates all parts. Notes snap to subdivision. Press <kbd>Delete</kbd> to remove selected note.</div>
      </div>
      </div>
    </section>

    <section class="panel">
      <div class="panel__head">
        <div class="panel__title">Score</div>
        <div class="panel__meta">
          <button class="panel__toggle" title="Collapse">‚ñº</button>
        </div>
      </div>
      <div class="panel__body staff-wrap">
        <svg id="staff" viewBox="0 0 4200 1400" xmlns="http://www.w3.org/2000/svg"></svg>
        <div class="legend">
          <b>Melody</b> (blue) + <b>Right Hand</b> (green): C4-A5 | <b>Left Hand</b> (amber): C2-E4 |
          Time: <b>4/4</b> | Measures: <b>8</b> | MIDI: 3 separate tracks
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="micro">Built with plain HTML/CSS/JS. No external libraries. Export to MIDI for your DAW.</div>
    </footer>
  </div>

  <script src="script.js"></script>
  <script>
    // Collapsible panels
    document.querySelectorAll('.panel__head, .panel-header').forEach(header => {
      header.addEventListener('click', () => {
        header.parentElement.classList.toggle('collapsed');
      });
    });
  </script>
</body>
</html>
